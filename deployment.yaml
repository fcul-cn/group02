apiVersion: apps/v1
kind: Deployment
metadata:
  name: artist-logic-rs-3
spec:
  replicas: 3
  selector:
    matchLabels:
      app: artist-logic
  template:
    metadata:
      labels:
        app: artist-logic
    spec:
      imagePullSecrets:
      - name: docker-cred
      containers:
      - name: artist-logic
        image: guilhermedsantos/cn_group02:artistlogic
        resources:
          requests:
            memory: "64Mi"
            cpu: "250m"
          limits:
            memory: "128Mi"
            cpu: "500m"
        imagePullPolicy: Always
        ports:
        - containerPort: 5001
        env:
        - name: API_TOKEN
          valueFrom:
            secretKeyRef:
              name: json-key
              key: API_TOKEN
        readinessProbe:
          initialDelaySeconds: 10
          httpGet:
            path: "/health"
            port: 5001
        livenessProbe:
          initialDelaySeconds: 10
          httpGet:
            path: "/health"
            port: 5001
        startupProbe:
          httpGet:
            path: "/health"
            port: 5001
          failureThreshold: 5
          periodSeconds: 10 
---

apiVersion: apps/v1
kind: Deployment
metadata:
  name: artist-model-rs-3
spec:
  replicas: 3
  selector:
    matchLabels:
      app: artist-model
  template:
    metadata:
      labels:
        app: artist-model
    spec:
      imagePullSecrets:
      - name: docker-cred
      containers:
      - name: artist-model
        image: guilhermedsantos/cn_group02:artistmodel
        resources:
          requests:
            memory: "64Mi"
            cpu: "250m"
          limits:
            memory: "128Mi"
            cpu: "500m"
        imagePullPolicy: Always
        env:
        - name: API_TOKEN
          valueFrom:
            secretKeyRef:
              name: json-key
              key: API_TOKEN
        livenessProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50052
        readinessProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50052
        startupProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50052
          failureThreshold: 5
          periodSeconds: 10    
---

apiVersion: apps/v1
kind: Deployment
metadata:
  name: artists-releases-model-rs-3
spec:
  replicas: 3
  selector:
    matchLabels:
      app: artists-releases-model
  template:
    metadata:
      labels:
        app: artists-releases-model
    spec:
      imagePullSecrets:
      - name: docker-cred
      containers:
      - name: artists-releases-model
        image: guilhermedsantos/cn_group02:artistsreleasesmodel
        resources:
          requests:
            memory: "64Mi"
            cpu: "250m"
          limits:
            memory: "128Mi"
            cpu: "500m"
        imagePullPolicy: Always
        env:
        - name: API_TOKEN
          valueFrom:
            secretKeyRef:
              name: json-key
              key: API_TOKEN
        livenessProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50053
        readinessProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50053
        startupProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50053
          failureThreshold: 5
          periodSeconds: 10
---

apiVersion: apps/v1
kind: Deployment
metadata:
  name: artists-tracks-model-rs-3
spec:
  replicas: 3
  selector:
    matchLabels:
      app: artists-tracks-model
  template:
    metadata:
      labels:
        app: artists-tracks-model
    spec:
      imagePullSecrets:
      - name: docker-cred
      containers:
      - name: artists-tracks-model
        image: guilhermedsantos/cn_group02:artiststracksmodel
        resources:
          requests:
            memory: "64Mi"
            cpu: "250m"
          limits:
            memory: "128Mi"
            cpu: "500m"
        imagePullPolicy: Always
        env:
        - name: API_TOKEN
          valueFrom:
            secretKeyRef:
              name: json-key
              key: API_TOKEN
        livenessProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50054
        readinessProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50054
        startupProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50054
          failureThreshold: 5
          periodSeconds: 10    
---

apiVersion: apps/v1
kind: Deployment
metadata:
  name: genre-logic-rs-3
spec:
  replicas: 3
  selector:
    matchLabels:
      app: genre-logic
  template:
    metadata:
      labels:
        app: genre-logic
    spec:
      imagePullSecrets:
      - name: docker-cred
      containers:
      - name: genre-logic
        image: guilhermedsantos/cn_group02:genrelogic
        resources:
          requests:
            memory: "64Mi"
            cpu: "250m"
          limits:
            memory: "128Mi"
            cpu: "500m"
        imagePullPolicy: Always
        ports:
        - containerPort: 5002
        env:
        - name: API_TOKEN
          valueFrom:
            secretKeyRef:
              name: json-key
              key: API_TOKEN
        readinessProbe:
          initialDelaySeconds: 10
          httpGet:
            path: "/health"
            port: 5002
        livenessProbe:
          initialDelaySeconds: 10
          httpGet:
            path: "/health"
            port: 5002
        startupProbe:
          httpGet:
            path: "/health"
            port: 5002
          failureThreshold: 5
          periodSeconds: 10
---

apiVersion: apps/v1
kind: Deployment
metadata:
  name: genre-model-rs-3
spec:
  replicas: 3
  selector:
    matchLabels:
      app: genre-model
  template:
    metadata:
      labels:
        app: genre-model
    spec:
      imagePullSecrets:
      - name: docker-cred
      containers:
      - name: genre-model
        image: guilhermedsantos/cn_group02:genremodel
        resources:
          requests:
            memory: "64Mi"
            cpu: "250m"
          limits:
            memory: "128Mi"
            cpu: "500m"
        imagePullPolicy: Always
        env:
        - name: API_TOKEN
          valueFrom:
            secretKeyRef:
              name: json-key
              key: API_TOKEN
        livenessProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50055
        readinessProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50055
        startupProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50055
          failureThreshold: 5
          periodSeconds: 10
---

apiVersion: apps/v1
kind: Deployment
metadata:
  name: playlist-logic-rs-3
spec:
  replicas: 3
  selector:
    matchLabels:
      app: playlist-logic
  template:
    metadata:
      labels:
        app: playlist-logic
    spec:
      imagePullSecrets:
      - name: docker-cred
      containers:
      - name: playlist-logic
        image: guilhermedsantos/cn_group02:playlistlogic
        resources:
          requests:
            memory: "64Mi"
            cpu: "250m"
          limits:
            memory: "128Mi"
            cpu: "500m"
        imagePullPolicy: Always
        ports:
        - containerPort: 5003
        env:
        - name: API_TOKEN
          valueFrom:
            secretKeyRef:
              name: json-key
              key: API_TOKEN
        readinessProbe:
          initialDelaySeconds: 10
          httpGet:
            path: "/health"
            port: 5003
        livenessProbe:
          initialDelaySeconds: 10
          httpGet:
            path: "/health"
            port: 5003
        startupProbe:
          httpGet:
            path: "/health"
            port: 5003
          failureThreshold: 5
          periodSeconds: 10
---

apiVersion: apps/v1
kind: Deployment
metadata:
  name: playlist-model-rs-3
spec:
  replicas: 3
  selector:
    matchLabels:
      app: playlist-model
  template:
    metadata:
      labels:
        app: playlist-model
    spec:
      imagePullSecrets:
      - name: docker-cred
      containers:
      - name: playlist-model
        image: guilhermedsantos/cn_group02:playlistmodel
        resources:
          requests:
            memory: "64Mi"
            cpu: "250m"
          limits:
            memory: "128Mi"
            cpu: "500m"
        imagePullPolicy: Always
        env:
        - name: API_TOKEN
          valueFrom:
            secretKeyRef:
              name: json-key
              key: API_TOKEN
        livenessProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50057
        readinessProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50057
        startupProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50057
          failureThreshold: 5
          periodSeconds: 10    
---

apiVersion: apps/v1
kind: Deployment
metadata:
  name: release-logic-rs-3
spec:
  replicas: 3
  selector:
    matchLabels:
      app: release-logic
  template:
    metadata:
      labels:
        app: release-logic
    spec:
      imagePullSecrets:
      - name: docker-cred
      containers:
      - name: release-logic
        image: guilhermedsantos/cn_group02:releaselogic
        resources:
          requests:
            memory: "64Mi"
            cpu: "250m"
          limits:
            memory: "128Mi"
            cpu: "500m"
        imagePullPolicy: Always
        ports:
        - containerPort: 5004
        env:
        - name: API_TOKEN
          valueFrom:
            secretKeyRef:
              name: json-key
              key: API_TOKEN
        readinessProbe:
          initialDelaySeconds: 10
          httpGet:
            path: "/health"
            port: 5004
        livenessProbe:
          initialDelaySeconds: 10
          httpGet:
            path: "/health"
            port: 5004
        startupProbe:
          httpGet:
            path: "/health"
            port: 5004
          failureThreshold: 5
          periodSeconds: 10
---

apiVersion: apps/v1
kind: Deployment
metadata:
  name: release-model-rs-3
spec:
  replicas: 3
  selector:
    matchLabels:
      app: release-model
  template:
    metadata:
      labels:
        app: release-model
    spec:
      imagePullSecrets:
      - name: docker-cred
      containers:
      - name: release-model
        image: guilhermedsantos/cn_group02:releasemodel
        resources:
          requests:
            memory: "64Mi"
            cpu: "250m"
          limits:
            memory: "128Mi"
            cpu: "500m"
        imagePullPolicy: Always
        env:
        - name: API_TOKEN
          valueFrom:
            secretKeyRef:
              name: json-key
              key: API_TOKEN
        livenessProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50058
        readinessProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50058
        startupProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50058
          failureThreshold: 5
          periodSeconds: 10    
---

apiVersion: apps/v1
kind: Deployment
metadata:
  name: track-logic-rs-3
spec:
  replicas: 3
  selector:
    matchLabels:
      app: track-logic
  template:
    metadata:
      labels:
        app: track-logic
    spec:
      imagePullSecrets:
      - name: docker-cred
      containers:
      - name: track-logic
        image: guilhermedsantos/cn_group02:tracklogic
        resources:
          requests:
            memory: "64Mi"
            cpu: "250m"
          limits:
            memory: "128Mi"
            cpu: "500m"
        imagePullPolicy: Always
        ports:
        - containerPort: 5000
        env:
        - name: API_TOKEN
          valueFrom:
            secretKeyRef:
              name: json-key
              key: API_TOKEN
        readinessProbe:
          initialDelaySeconds: 10
          httpGet:
            path: "/health"
            port: 5000
        livenessProbe:
          initialDelaySeconds: 10
          httpGet:
            path: "/health"
            port: 5000
        startupProbe:
          httpGet:
            path: "/health"
            port: 5000
          failureThreshold: 5
          periodSeconds: 10
---

apiVersion: apps/v1
kind: Deployment
metadata:
  name: track-model-rs-3
spec:
  replicas: 3
  selector:
    matchLabels:
      app: track-model
  template:
    metadata:
      labels:
        app: track-model
    spec:
      imagePullSecrets:
      - name: docker-cred
      containers:
      - name: track-model
        image: guilhermedsantos/cn_group02:trackmodel
        resources:
          requests:
            memory: "64Mi"
            cpu: "250m"
          limits:
            memory: "128Mi"
            cpu: "500m"
        imagePullPolicy: Always
        env:
        - name: API_TOKEN
          valueFrom:
            secretKeyRef:
              name: json-key
              key: API_TOKEN
        livenessProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50051
        readinessProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50051
        startupProbe:
          exec:
            command:
            - /bin/grpc_health_probe
            - -addr=:50051
          failureThreshold: 5
          periodSeconds: 10   

---

apiVersion: apps/v1
kind: Deployment
metadata:
  name: auth-rs-3
spec:
  replicas: 3
  selector:
    matchLabels:
      app: auth-logic
  template:
    metadata:
      labels:
        app: auth-logic
    spec:
      imagePullSecrets:
      - name: docker-cred
      containers:
      - name: auth-logic
        image: guilhermedsantos/cn_group02:auth
        resources:
          requests:
            memory: "64Mi"
            cpu: "250m"
          limits:
            memory: "128Mi"
            cpu: "500m"

        imagePullPolicy: Always
        ports:
        - containerPort: 5055
        env:
        - name: API_TOKEN
          valueFrom:
            secretKeyRef:
              name: json-key
              key: API_TOKEN
        readinessProbe:
          initialDelaySeconds: 10
          httpGet:
            path: "/health"
            port: 5055
        livenessProbe:
          initialDelaySeconds: 10
          httpGet:
            path: "/health"
            port: 5055
        startupProbe:
          httpGet:
            path: "/health"
            port: 5055
          failureThreshold: 5
          periodSeconds: 10

---

apiVersion: v1
kind: Service
metadata:
  name: auth-logic-rs-3
spec:
  selector:
    app: auth-logic
  ports:
    - protocol: TCP
      port: 5055
      targetPort: 5055

---

apiVersion: v1
kind: Service
metadata:
  name: track-logic-rs-3
spec:
  selector:
    app: track-logic
  ports:
    - protocol: TCP
      port: 5000
      targetPort: 5000
---
apiVersion: v1
kind: Service
metadata:
  name: artist-logic-rs-3
spec:
  selector:
    app: artist-logic
  ports:
    - protocol: TCP
      port: 5001
      targetPort: 5001
---
apiVersion: v1
kind: Service
metadata:
  name: genre-logic-rs-3
spec:
  selector:
    app: genre-logic
  ports:
    - protocol: TCP
      port: 5002
      targetPort: 5002
---
apiVersion: v1
kind: Service
metadata:
  name: playlist-logic-rs-3
spec:
  selector:
    app: playlist-logic
  ports:
    - protocol: TCP
      port: 5003
      targetPort: 5003
---
apiVersion: v1
kind: Service
metadata:
  name: release-logic-rs-3
spec:
  selector:
    app: release-logic
  ports:
    - protocol: TCP
      port: 5004
      targetPort: 5004
---
apiVersion: v1
kind: Secret
metadata:
  name: testsecret-tls
  namespace: default
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZFVENDQXZtZ0F3SUJBZ0lVQ2l0ZUxjVVlDTlFtUHJIdElMQWRBN2UvQUZjd0RRWUpLb1pJaHZjTkFRRUwKQlFBd0dERVdNQlFHQTFVRUF3d05aM0p2ZFhBd01tTnVMbU52YlRBZUZ3MHlOREEwTVRZeE5UVTVNRGxhRncweQpOVEEwTVRZeE5UVTVNRGxhTUJneEZqQVVCZ05WQkFNTURXZHliM1Z3TURKamJpNWpiMjB3Z2dJaU1BMEdDU3FHClNJYjNEUUVCQVFVQUE0SUNEd0F3Z2dJS0FvSUNBUURTdTdPNTQyeUt2K0o0eUptSWZuUVhtTXV5MmNGbUpCNXYKWmxLSHNaSjBPb0M1dlRlYUJETlJ6cGtzcm5tMzlERXNjSVBpdXF3S0VCeFpxUEg3RVFUbi9JeDJQdEw4a0l4VQpCM2dBRlFIS3Baem95aWpQR3dZS3p0ZVlnbm9lV2dWUWRFZ3dhaEpQZFZFK0FBak5GREpxemx5cjNyamdia01wClVLb21RNzRWalR0bEdBMlovYzBOZmRSOU5mYzFhSWhLSVdEQ2VMYVlOUjNUajhDRUFwWFFPOGxLODVBdVJHaU0KSzUraGFZNkFvRVR5MXYzRmpUWlgvQzVKaG9Sb2dMNnVqdjc5d0lnTENHd0x5QTYrTUJvcW5mU1BIZHlTZklSWApKYnBNZmhNSDBPY2tNbHlQN1JvT1l6YjZwRlNibVhPSkdKSXZDUFY4Z1FaQnFsL1g1M3ZjRXNxOXRhV3dic0t6CjRBdUNYRklyL2M3RTY4MDI2TWhsY1hSNXRpUkdvRnY3ekIrOXVCWGRBWHVXVlQ3bmtOOFltMzFBN0FaWEphYTQKNlZZZGpodjZZUjFhSlZYQjlUK1lZSjByTzhTcG9mZXc5a2RlZlp4QnZreWdTQzRjcUtlQzZFTkFzTHYzVlZyOQpGcXJzdXRBNUhEOWNPcmVGMENVclg4Sjlvb1IwNE5JcG1yZkhRcDYvTzlGSmR4TEhDVjgyaWdGRFBFekI0bk9xCmh0NThlaTJMQVBGdE9NZjlQWXNvMlUxcExwNHgrR1hRWnFXQzB0N0J0NS9lbHNZVzlLdzZkRzZFUGo0T0NYTTgKcE5IaTF2NThzSGQyaFhFMlZjd2d5MTVoczJlUU4xeVRQaVIrZS9kRVgydk9Zei9EUkxOZitVdjZkNnRncHNXRgpXWmwwQXlRUFN3SURBUUFCbzFNd1VUQWRCZ05WSFE0RUZnUVVYWWI1ZHFUeGRYOEt0Q2xJOUZpMGJ0Z2hidDB3Ckh3WURWUjBqQkJnd0ZvQVVYWWI1ZHFUeGRYOEt0Q2xJOUZpMGJ0Z2hidDB3RHdZRFZSMFRBUUgvQkFVd0F3RUIKL3pBTkJna3Foa2lHOXcwQkFRc0ZBQU9DQWdFQVBkaXNPVEwyQXdoU0tHOUlLdjBxYzdaTzRsb3JPaDY4NTU1dApITk4rZnpOeGlqRjlMMndGSE9aVEpQaTFDczdnNlI1dHZTbklTSit2dExzVkl1ZlpHcnJHVnFnb3VPdHlETW90ClIyK3QrMzl3dDg3bGJtUXhzV1R2V0JtRThHQkdmSnJjYm82djZzWDVDSlRldi9HVXFaRHJHQlQ0Nk1HYlp1Zm0KWEx6TjdleldCcHpQYmF1YlVXZEswZ3pXamxVbTI2eDIrWGQvZ1cxNjR0L1V5TjgrbjlVUGdpMUtvWkNENG1Bcgo5Y0VCMUdCazVkdWVONU1HK3ZCZCt6Sk1CZy9Ea1dUS2NzcE9aY1JqQVBlSUFzekpENTJFOXcwKzF5VnhXT0xmCm9ITXV3QlJ4MWVNcHFmOXNtd0E3ZGJqQjJZSTVEQUdQUFRKRW95Qmg3dUJXR2RTY1RCQnoxRVRNOTI5YUNNS20KZmZYMVF0OS9XY1JXMGFFUjc3MnNDd01xbWZRSnV3Z2lwNHkvQ2RGZkR3MUJiTmd0dk1zbzVESDgxZ0E0TzRvcQpkOWlIMmRkcDY3ZFlhajd5bnRuY1NjUzJxWmVJK0h1clJ4Z0NRZEl0bUxkbTBnMEJydVpsVS9nYWRwZDZQMVhkCmcyMWpLMEdUbStBTmV0bjNsMnFaRG5GTWpPTld6RHIyeTU1SUNMdTRqTzF3Q1d6WGtrK3ZscmZlUmNUNjI1MmoKdFpkMUpOeGJPd052OVdEWEMwUUk5RjFlZ1lVV0cyZThvYkVpb3dtTkhqK2xNWWV1V0lrelByclQ5Qm8vdi9PcQpwQjRsb2FHY0ZDM1NJVDlwdmp6VStjRTg1R3paaWphMnk3dGZ1N0s4M3VEcG1xZW8wWU1sVzhjZUFNOWVqa2J4Clg1YmJMZGM9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUpRZ0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQ1N3d2dna29BZ0VBQW9JQ0FRRFN1N081NDJ5S3YrSjQKeUptSWZuUVhtTXV5MmNGbUpCNXZabEtIc1pKME9vQzV2VGVhQkROUnpwa3Nybm0zOURFc2NJUGl1cXdLRUJ4WgpxUEg3RVFUbi9JeDJQdEw4a0l4VUIzZ0FGUUhLcFp6b3lpalBHd1lLenRlWWdub2VXZ1ZRZEVnd2FoSlBkVkUrCkFBak5GREpxemx5cjNyamdia01wVUtvbVE3NFZqVHRsR0EyWi9jME5mZFI5TmZjMWFJaEtJV0RDZUxhWU5SM1QKajhDRUFwWFFPOGxLODVBdVJHaU1LNStoYVk2QW9FVHkxdjNGalRaWC9DNUpob1JvZ0w2dWp2Nzl3SWdMQ0d3TAp5QTYrTUJvcW5mU1BIZHlTZklSWEpicE1maE1IME9ja01seVA3Um9PWXpiNnBGU2JtWE9KR0pJdkNQVjhnUVpCCnFsL1g1M3ZjRXNxOXRhV3dic0t6NEF1Q1hGSXIvYzdFNjgwMjZNaGxjWFI1dGlSR29Gdjd6Qis5dUJYZEFYdVcKVlQ3bmtOOFltMzFBN0FaWEphYTQ2Vllkamh2NllSMWFKVlhCOVQrWVlKMHJPOFNwb2ZldzlrZGVmWnhCdmt5ZwpTQzRjcUtlQzZFTkFzTHYzVlZyOUZxcnN1dEE1SEQ5Y09yZUYwQ1VyWDhKOW9vUjA0TklwbXJmSFFwNi9POUZKCmR4TEhDVjgyaWdGRFBFekI0bk9xaHQ1OGVpMkxBUEZ0T01mOVBZc28yVTFwTHA0eCtHWFFacVdDMHQ3QnQ1L2UKbHNZVzlLdzZkRzZFUGo0T0NYTThwTkhpMXY1OHNIZDJoWEUyVmN3Z3kxNWhzMmVRTjF5VFBpUitlL2RFWDJ2TwpZei9EUkxOZitVdjZkNnRncHNXRldabDBBeVFQU3dJREFRQUJBb0lDQUd3NjRPeVl4RGRpbzdMNisvZWhVb2lICi9oNW1QakR5WGZ0QzV5SXY3aExwdFJFd0FDMkcrTUNNUmhrdnB1MzJhWWIwWnBmODNienhWMDRwT2RhRGdDeVIKaGFaNVQ2MU5vL1RJUFRaMWs0ejdqK0h6YWhBc1JlY3BJb3QrZjYrMDlrUEM1UXlRZmNUM2NQbFIxVE5XcXlvMQp3Rnk1TCtSOFhOd01STWNRUmNFVjN5cGx0eDZldmtDdW5vS01RK0hYUlNBbGttZHV6Z0RRVHZoSVBVelBjeGdXCmpLU0ZBVWp4ODJ3Q1A2TUw3cGRiT080cnd2eENNV1h3NitqeFFISFhwWmRMYytUcGpEVjJadCtLS1NBKzNrR0QKRElhd2hJZHJraUNjRE5tYWFyVzU4ZXlpUE8zaWpWNVVVSGxjQ3VRN1pKNUYwMVo2MkhIUVptRTFXckl0Zm11egpNUVJ4TGl0aE9GNDBYUVN4THc4dEw5THNVSjdQRmxlMWhxM0FmSnFEVEpuNUp0YXBEVHljNHp5elB3Uzl0WVI5CkEraU5haWsyWTJpOURXUEVETTZwdFN2dmpRSE9QdEpFbHhMTGlxS1BtUFJJdmR4WnFndWwxRDdWbDY1WWdYQkoKd1BGdmxEMFNlQmh4VFJSNWN3WExKcWJpQng3VXhPN20rbDlsUEI2ZlE1MXBXVEtGTUhac00ybE9ydUdaVmc4WApFY0NXZ2ZhSGgyNHQvQU9keEY1OHZzek1RaW5UQWxUQ2MyUXlPM2RTS0dYYldLRXlkVnptMGpHK2diS2E1dGFDCmVROGlVMXYrWUhQK25LRmFWeXJ1bkQ1ak10NTRyYmdBM1JKOUNJNDdyS0pQVWJBZ1U4OWtTMUdnV1VwR1B0WkcKOTBCY29BS1MvVUhmMmZMUUZldEpBb0lCQVFEdzhMVG9ycHVGZFVOY1NDNXgwSzQvVGJFQlBsWUNNYjdDWEVlTQpVNDFXWlAzeU1vNnJkMTUwYUxhd0toeVZJaktwVXVrcDgrOHFROExRejFNZ1k0eFliek1HcDZycGZFVEU1eGYrCmVYNFFOa2dOdWVXak82YjZheTNUaUI5SkZhcGVJS3UyUTVBbndyL1c4RXEyc3hBVGtyOE5xVFAwVXRiNnY2ZzAKK1JGSXlGejJoU3pvZ2RRallnWjF0azh3dXZmWmVoeWxFYmVNZlFXQjN4RUQxSGhtUDVxdzhzbGJrNUc4bi9DMwp5ZnhWTWRTRjNWYXpBdE9oWmJaaWJBNVAzclNDTUtMTjkyalQzSklFN3ZkeDY0MG9kdUZYUDUrcklVcHRuQU0wCnpBamk0ejBldS9QU25Sdm54WjFNWkF4TzUrYStmckEzdnNhR0swNjk0eGJtUWhzVkFvSUJBUURmNTZhL0hqOHEKWk5pNjNWTFpoakpGWUQ1QmpqVlJpOUo0andwV3M1QkZyS0R4Sjl6MlBuUEQ1NEJoUDRsNFVURklyVmkyeGFNYwpyK29zbHVEUERjQ3VXVWFudUVkb204ZmJyaHZyb3Jua2xjNm80RzA2UUhBTmM0b3Z5RlIxQXdVbk1zK2hLTDVoCkxOcnJacGQ0ZGtZN0Zzb0hlZWRDRlBrbVZvdjF2RmNpQXVkS3dmaWpCMk83WFhJQi9iVHBKQlAvY2grbEQ2b3kKTTZqaFM0NUladTJsdUg3OVBnQTVOKzI0UGtrZklWbVA0d0dIOFppdis1TVhScW9EWEMxL0UwRzJsZ0RQSTFSbQpubm1IZ1dKbXZGUGNFUkIxTHV2a1V4dXVHdTlLZWxBREZEQTlOUjI5Zys1QXEzcHkzMkE2ZFVvYk9CUStISHAzCkFSeWNkWVVvRXBqZkFvSUJBQW5taWppSmZFQ0dxZ2J2dkdEVzUySVlpaTUzNWtiZXptemtKOWgvVW01N1plZisKNWRmcjVzaTN5TklDV1B4VDFHc2F5aFA4UHhhb2hDZmFiUnNHbkN6Q0hRR29BQ0RxQjFWai9adHFXS0RINmp3TwpLSDZGby8za1M1VEdvaXA1cG0rSnZpU1dNQ1ZDSG1ueG85QlFHVmdFanE4OEJiT0RkK3dEMWlDZkgzT3pNQWE5ClFEUXBxWkx1b3o5UkIzNEVJTTBoOUcxZ0JmL1MzMWdQMTM0bHkvQy9xbGFkRTJNYzlEOGcvMTQrQVkxcXA4WDgKYTJTZHVCNkl0RzdrNjgyaVpCNTVheWMxaEd3NFF4UEswZ1l2WExTTjlnS0V6Y1hWYjE2RHE2b092RXErZGJOKwptNjFLNFd1cnRpUCtkSGNGbG5pN2NmaEljWlh2ejZPRDRsd0IyV1VDZ2dFQVZtMGpoeWdVdDdkL2xQbXpialdICm1CSGpWZ2lmZWgrZm1WdVZZUXdreDFBd080WG9tOEJWalN3QitRZStkNHZYbXpjV1JFNmJmSXBHdVBsd1Exd0sKb1FIaTdRQ0x4OHhCNUFFYjArUFhIMjNYL0lYTWc2eTEwK3RpVHJsa0tGcUhGYTllUjlYalRyMHlyNlRGR1FHRwpjRzZHZzBaQnh0Y3pxT0hGV3BCZGpjcFRIeDhxYXp1QitxUENTeFIwVFgzWW5rU2VCR2U4aVc0NVpPVjJRV3BCCmx6TlZDVWx5YXFPMUJlWTg4V0E5SXZZNzlBNkVvb0ZZTUtiZEh6am9jdUdxL3VCOTVYYThzSFBCYzFXMDl2VUEKNWJSTWh2OGFuT0tiajZQajgvcXNnZE84SHhRdXE2V09STFlzS01VaWJzNHhVYnBlemU3T01ydGlJTjZZREhUSgpQd0tDQVFFQWhTRlJDWlVmMUhneWJjVHNMOUhHd0d4K3RSYmZOOXRRcjNTTDlzWFl5bXQ2Z3hvK0w0bXE3SWZjCmpRZm9wTXlKczExY2dJYk93bDBiQ2NnQmp3NzhwTlUxeWUwaWJaRjZXOHlKdlpWejdJcFdqODZCZWljc3hZb2wKTUpiMEJlZStuTUhVbXZmblhlVSt5K1NkbTdmNTZXWUFnN3d5cTQ2OVJ1clNCejhlalJwaTE1aHkvbG83UW5PQQpWQ0JZOWg1eFZVTFQ5MFFmZ25yZFNZTCt6a3I0VGNrNE53d3E3ZVg1V04vTHpTWmcrZElJNllIZkNRS0U3Nzd2Cmo3SlVxQzljV2NUellUTDdSdDhGZlNhWE02Z1ZRaVljZERsVnVqU0dRamw2NUc4bjR5SzVFZXdJRnphbGNsZGkKWHIzbC8yeEF5RURIRjlidk5VTVdTODZZUUt1ZHdRPT0KLS0tLS1FTkQgUFJJVkFURSBLRVktLS0tLQo=
type: kubernetes.io/tls
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: api-gateway-ingress
  annotations:
    nginx.ingress.kubernetes.io/auth-url: "https://group02cn.com/api/auth/token/validate"
    nginx.ingress.kubernetes.io/auth-signin: "https://group02cn.com/api/auth/login"
    nginx.ingress.kubernetes.io/auth-response-headers: "authorization"
spec:
  tls:
    - hosts:
        - group02cn.com
      secretName: testsecret-tls
  rules:
  - host: group02cn.com
    http:
      paths:
      - pathType: Prefix
        path: "/api/tracks"
        backend:
          service:
            name: track-logic-rs-3
            port:
              number: 5000
      - pathType: Prefix
        path: "/api/artists"
        backend:
          service:
            name: artist-logic-rs-3
            port:
              number: 5001
      - pathType: Prefix
        path: "/api/genres"
        backend:
          service:
            name: genre-logic-rs-3
            port:
              number: 5002
      - pathType: Prefix
        path: "/api/playlists"
        backend:
          service:
            name: playlist-logic-rs-3
            port:
              number: 5003
      - pathType: Prefix
        path: "/api/releases"
        backend:
          service:
            name: release-logic-rs-3
            port:
              number: 5004 
---
#HORIZONTAL POD AUTOSCALING

apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: artist-logic-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: artist-logic-rs-3
  minReplicas: 1
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 80
    - type: Resource
      resource:
        name: memory
        target:
          type: AverageValue
          averageValue: 200Mi

---

apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: artist-model-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: artist-model-rs-3
  minReplicas: 1
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 80
    - type: Resource
      resource:
        name: memory
        target:
          type: AverageValue
          averageValue: 200Mi

---

apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: artists-releases-model-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: artists-releases-model-rs-3
  minReplicas: 1
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 80
    - type: Resource
      resource:
        name: memory
        target:
          type: AverageValue
          averageValue: 200Mi

---

apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: artists-tracks-model-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: artists-tracks-model-rs-3
  minReplicas: 1
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 80
    - type: Resource
      resource:
        name: memory
        target:
          type: AverageValue
          averageValue: 200Mi

---

apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: genre-logic-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: genre-logic-rs-3
  minReplicas: 1
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 80
    - type: Resource
      resource:
        name: memory
        target:
          type: AverageValue
          averageValue: 200Mi

---

apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: genre-model-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: genre-model-rs-3
  minReplicas: 1
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 80
    - type: Resource
      resource:
        name: memory
        target:
          type: AverageValue
          averageValue: 200Mi

---

apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: playlist-logic-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: playlist-logic-rs-3
  minReplicas: 1
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 80
    - type: Resource
      resource:
        name: memory
        target:
          type: AverageValue
          averageValue: 200Mi

---

apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: playlist-model-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: playlist-model-rs-3
  minReplicas: 1
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 80
    - type: Resource
      resource:
        name: memory
        target:
          type: AverageValue
          averageValue: 200Mi

---

apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: release-logic-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: release-logic-rs-3
  minReplicas: 1
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 80
    - type: Resource
      resource:
        name: memory
        target:
          type: AverageValue
          averageValue: 200Mi

---

apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: release-model-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: release-model-rs-3
  minReplicas: 1
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 80
    - type: Resource
      resource:
        name: memory
        target:
          type: AverageValue
          averageValue: 200Mi

---

apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: track-logic-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: track-logic-rs-3
  minReplicas: 1
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 80
    - type: Resource
      resource:
        name: memory
        target:
          type: AverageValue
          averageValue: 200Mi

---

apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: track-model-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: track-model-rs-3
  minReplicas: 1
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 80
    - type: Resource
      resource:
        name: memory
        target:
          type: AverageValue
          averageValue: 200Mi

---

apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: auth-rs-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: auth-rs-3
  minReplicas: 1
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 80
    - type: Resource
      resource:
        name: memory
        target:
          type: AverageValue
          averageValue: 200Mi
